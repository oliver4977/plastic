<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ν”λΌμ¤ν‹± μ κ° ν¬μΈνΈ κ³„μ‚°κΈ°</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f8fc;
      margin: 0;
      padding: 20px 20px 20px 260px;
    }

    header {
      background-color: #2a5d9f;
      color: white;
      padding: 15px;
      font-size: 20px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
    }

    .sidebar {
      position: fixed;
      top: 60px;
      left: 0;
      width: 240px;
      background-color: #eef3fa;
      height: 100%;
      padding: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    }

    .sidebar h3 {
      color: #2a5d9f;
      margin-bottom: 10px;
    }

    .sidebar p {
      font-size: 18px;
      color: #007700;
      font-weight: bold;
    }

    main {
      max-width: 600px;
      margin: 100px auto;
      padding: 20px;
    }

    input, button {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
    }

    button {
      background-color: #2a5d9f;
      color: white;
      border: none;
      cursor: pointer;
    }

    .card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-top: 20px;
    }

    .highlight {
      color: #007700;
      font-weight: bold;
    }

    .message {
      margin-top: 10px;
      padding: 10px;
      background-color: #e6f7ff;
      border-left: 5px solid #3399ff;
    }

    .notice {
      font-size: 14px;
      color: #666;
      margin-top: 30px;
      background: #fff4d6;
      padding: 10px;
      border-left: 4px solid #ffaa00;
    }

    .history {
      background: #fff;
      margin-top: 20px;
      padding: 15px;
      border: 1px dashed #999;
    }
  </style>
</head>
<body>

  <header>ν”λΌμ¤ν‹± μ κ° ν¬μΈνΈ μ‹μ¤ν…</header>

  <div class="sidebar">
    <h3>πΆ λ„μ  ν¬μΈνΈ</h3>
    <p id="pointBox">λ‹¨μ§€λ¥Ό μ…λ ¥ν•μ„Έμ”</p>
  </div>

  <main>
    <h2>μ΄λ² λ‹¬ μ‚¬μ©λ‰μ„ μ…λ ¥ν•μ„Έμ”</h2>
    <input type="text" id="aptName" placeholder="λ‹¨μ§€ μ΄λ¦„ (μ: ν•λ‚΄λ“¤)">
    <input type="number" id="usage" placeholder="μ΄λ² λ‹¬ μ‚¬μ©λ‰ (kg)">
    <input type="number" id="target" placeholder="λ©ν‘ μ‚¬μ©λ‰ μ„¤μ • (kg)">
    <button onclick="calculate()">κ³„μ‚°ν•κΈ°</button>

    <div class="card" id="output" style="display:none;"></div>

    <button onclick="showHistory()">π“… μ›”λ³„ κΈ°λ΅ λ³΄κΈ°</button>
    <div id="history" class="history" style="display:none;"></div>

    <div class="notice">
      β€» μ‹¤μ μ• μ„λ” μ§μ ‘μ…λ ¥μ΄ μ•„λ‹ κ³„λ‰κΈ°λ¥Ό μ΄μ©ν•μ—¬ μλ£λ¥Ό μ§‘κ³„ν•©λ‹λ‹¤
    </div>
  </main>

  <script>
    const κΈ°μ¤€λ‰ = 100;

    function calculate() {
      const apt = document.getElementById("aptName").value.trim();
      const usage = parseFloat(document.getElementById("usage").value);
      const target = parseFloat(document.getElementById("target").value);

      if (!apt || isNaN(usage) || isNaN(target)) {
        alert("λ¨λ“  μ •λ³΄λ¥Ό μ •ν™•ν μ…λ ¥ν•΄μ£Όμ„Έμ”.");
        return;
      }

      const μ κ°λ‰ = Math.max(0, κΈ°μ¤€λ‰ - usage);
      const ν¬μΈνΈ = μ κ°λ‰ * 10;
      const κ°λ©΄μ•΅ = ν¬μΈνΈ * 100;
      const co2μ κ° = μ κ°λ‰ * 2.5;

      const now = new Date();
      const yearMonth = now.toISOString().slice(0, 7); // "2025-07"

      // λ„μ  ν¬μΈνΈ μ €μ¥
      const key = `point_${apt}`;
      const κΈ°μ΅΄ν¬μΈνΈ = parseInt(localStorage.getItem(key)) || 0;
      const λ„μ ν¬μΈνΈ = κΈ°μ΅΄ν¬μΈνΈ + ν¬μΈνΈ;
      localStorage.setItem(key, λ„μ ν¬μΈνΈ);

      // μ›”λ³„ λ³€ν™” μ €μ¥
      const monthKey = `history_${apt}_${yearMonth}`;
      localStorage.setItem(monthKey, JSON.stringify({
        usage: usage,
        point: ν¬μΈνΈ
      }));

      // μΉ­μ°¬ λ©”μ‹μ§€
      let μΉ­μ°¬ = "";
      if (μ κ°λ‰ >= 20) {
        μΉ­μ°¬ = "π‰ ν™κ²½ μμ›…μ…λ‹λ‹¤! ν° μ κ°μ„ λ‹¬μ„±ν–μ–΄μ”!";
      } else if (μ κ°λ‰ >= 10) {
        μΉ­μ°¬ = "π‘ μ°μ μ κ°! μ§€μ†μ μΈ λ…Έλ ¥μ΄ λ³΄μ—¬μ”!";
      } else if (μ κ°λ‰ > 0) {
        μΉ­μ°¬ = "π μΆ‹μ€ μ¶λ°μ…λ‹λ‹¤! λ‹¤μ λ‹¬λ„ κΈ°λ€λΌμ”!";
      } else {
        μΉ­μ°¬ = "β οΈ κΈ°μ¤€λ³΄λ‹¤ λ” λ§μ΄ μ‚¬μ©ν–μ–΄μ”. ν•¨κ» μ¤„μ—¬λ΄μ”!";
      }

      let λ©ν‘κ²°κ³Ό = "";
      if (usage <= target) {
        λ©ν‘κ²°κ³Ό = `β… μ„¤μ •ν• λ©ν‘(${target}kg) λ‹¬μ„±μ— μ„±κ³µν–μµλ‹λ‹¤!`;
      } else {
        λ©ν‘κ²°κ³Ό = `β λ©ν‘(${target}kg) λ‹¬μ„± μ‹¤ν¨. λ‹¤μ λ‹¬μ—” κ°€λ¥ν•΄μ”!`;
      }

      // μ¶λ ¥
      const output = document.getElementById("output");
      output.style.display = "block";
      output.innerHTML = `
        <h3>${apt} λ‹¨μ§€μ κ²°κ³Ό</h3>
        β–Έ κΈ°μ¤€ μ‚¬μ©λ‰: <span class="highlight">${κΈ°μ¤€λ‰}kg</span><br>
        β–Έ μ‹¤μ  μ‚¬μ©λ‰: <span class="highlight">${usage}kg</span><br>
        β–Έ μ κ°λ‰: <span class="highlight">${μ κ°λ‰}kg</span><br>
        β–Έ μ΄λ² λ‹¬ ν¬μΈνΈ: <span class="highlight">${ν¬μΈνΈ}μ </span><br>
        β–Έ κ°λ©΄ μμƒμ•΅: <span class="highlight">${κ°λ©΄μ•΅.toLocaleString()}μ›</span><br>
        β–Έ μ΄μ‚°ν™”νƒ„μ† μ κ°λ‰: <span class="highlight">${co2μ κ°.toFixed(1)}kg</span>
        <div class="message">${μΉ­μ°¬}<br>${λ©ν‘κ²°κ³Ό}</div>
      `;

      // ν¬μΈνΈ λ°•μ¤ κ°±μ‹ 
      document.getElementById("pointBox").innerHTML = `${apt} λ‹¨μ§€<br>π’  ${λ„μ ν¬μΈνΈ}μ `;
    }

    function showHistory() {
      const apt = document.getElementById("aptName").value.trim();
      if (!apt) {
        alert("λ‹¨μ§€ μ΄λ¦„μ„ λ¨Όμ € μ…λ ¥ν•μ„Έμ”.");
        return;
      }

      let output = `<h3>${apt} λ‹¨μ§€μ μ›”λ³„ κΈ°λ΅</h3><ul>`;
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith(`history_${apt}_`)) {
          const month = key.replace(`history_${apt}_`, '');
          const data = JSON.parse(localStorage.getItem(key));
          output += `<li>${month} : μ‚¬μ©λ‰ ${data.usage}kg β†’ ν¬μΈνΈ ${data.point}μ </li>`;
        }
      }
      output += `</ul>`;

      const historyDiv = document.getElementById("history");
      historyDiv.innerHTML = output;
      historyDiv.style.display = "block";
    }
  </script>

</body>
</html>
